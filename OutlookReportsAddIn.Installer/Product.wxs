<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">

  <!-- Define product -->
  <?if $(var.Platform)=x64?>
  <?define ProductCode = "{EBBB38F5-F6AE-423B-BC15-B9907CABC9A9}"?>
  <?else?>
  <?define ProductCode = "{4702C666-FA56-4623-89ED-74FA75925FEE}"?>
  <?endif?>

  <?define UpgradeCode = "{266D553F-0521-483F-BBB3-F5CCE11822F2}"?>
  
  <?define BuildVersion = 1.0.0.0 ?>
  
  <!-- Define main product -->
  <Product Id="$(var.ProductCode)" 
           Name="!(loc.ProductName_$(var.Platform))" 
           Language="!(loc.Language)" 
           Version="$(var.BuildVersion)" 
           Manufacturer="!(loc.Company)" 
           UpgradeCode="$(var.UpgradeCode)"
           >
    <!-- Provide package details -->
		<Package InstallerVersion="200" 
             Compressed="yes" 
             InstallScope="perMachine"
             Platform="$(var.Platform)"
             Manufacturer="!(loc.Company)"
             Description="!(loc.Description)"             
             Comments="!(loc.Comments)"
             Keywords="!(loc.Keywords)"
             />

		<!-- Downgrade error message -->
    <MajorUpgrade DowngradeErrorMessage="!(loc.DowngradeErrorMessage)"/>
		
    <!-- Include .cab files to .msi file -->
    <MediaTemplate 
      EmbedCab="yes"
      />

    <!-- Define main app icon -->
    <Icon Id="icon.ico" SourceFile="$(var.OutlookReportsAddIn.ProjectDir)\outlook-icon.ico"/>

    <!-- Use icon.ico for this installer (shows up in Add/Remove programs) -->
    <Property Id="ARPPRODUCTICON">icon.ico</Property>    
    <Property Id="ARPURLINFOABOUT">https://github.com/kaanlab/OutlookReportsAddIn</Property>

    <UIRef Id="WixUI_Minimal" />
    <WixVariable Id="WixUILicenseRtf" Value="$(var.ProjectDir)\Assets\License.rtf"/>
    
		<!-- Define components, shortcuts, files etc for installer -->
    <Feature Id="ProductFeature" Title="Installer for OutlookReportsAddIn" Level="1">
			
      <ComponentGroupRef Id="ProductComponents" />
      <ComponentRef Id="Registry_FriendlyName" />
      <ComponentRef Id="Registry_Description" />
      <ComponentRef Id="Registry_Manifest" />
      <ComponentRef Id="Registry_LoadBehavior" />
      
    </Feature>
	
  </Product>

</Wix>
